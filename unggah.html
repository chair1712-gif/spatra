 <!DOCTYPE html>
<html>
<head>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Upload File Mudah</title>
</head>
<body style='font-family: Arial; padding: 20px; max-width: 400px; margin: auto;'>
  
  <h2 style='color: #1976d2;'>ğŸ“ Upload File Mudah</h2>
  <p>File akan disimpan di folder <strong>FILE_UPLOAD</strong> di Google Drive</p>
  
  <div style='background: #f5f5f5; padding: 20px; border-radius: 10px;'>
    <div>
      <label style='display: block; margin-bottom: 5px;'>Nama Anda:</label>
      <input type='text' id='nama' placeholder='Contoh: Andi' 
             style='width: 100%; padding: 10px; margin-bottom: 15px; box-sizing: border-box;'>
    </div>
    
    <div>
      <label style='display: block; margin-bottom: 5px;'>Pilih File:</label>
      <input type='file' id='fileInput' 
             style='width: 100%; padding: 10px; margin-bottom: 15px; box-sizing: border-box;'>
    </div>
    
    <button onclick='uploadFile()' 
            style='width: 100%; padding: 12px; background: #1976d2; color: white; border: none; border-radius: 5px; cursor: pointer;'>
      ğŸ“¤ UPLOAD FILE
    </button>
  </div>
  
  <div id='status' style='margin-top: 20px; padding: 15px; border-radius: 5px; display: none;'></div>
  
  <div id='result' style='margin-top: 20px; padding: 15px; background: #e8f5e8; border-radius: 5px; display: none;'>
    <h3 style='color: #2e7d32;'>âœ… Upload Berhasil!</h3>
    <p>File tersimpan di Google Drive</p>
    <p><a href='#' id='fileLink' target='_blank' style='color: #1976d2;'>ğŸ”— Buka File</a></p>
  </div>

<script>
// URL Apps Script Anda (ganti dengan URL deployment Anda)
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx5m2daJGktEbDP2Fl_Np2ZSoCbQY6mqFKyHyPfpzW10I74Mswv7F_O8-7Nyh5o9C2k/exec';

async function uploadFile() {
  const nama = document.getElementById('nama').value.trim();
  const fileInput = document.getElementById('fileInput');
  const file = fileInput.files[0];
  const status = document.getElementById('status');
  const result = document.getElementById('result');
  
  // Reset display
  status.style.display = 'block';
  result.style.display = 'none';
  
  // Validasi
  if (!nama) {
    status.innerHTML = 'âŒ Masukkan nama Anda';
    status.style.background = '#ffebee';
    status.style.color = '#c62828';
    return;
  }
  
  if (!file) {
    status.innerHTML = 'âŒ Pilih file terlebih dahulu';
    status.style.background = '#ffebee';
    status.style.color = '#c62828';
    return;
  }
  
  // Tampilkan loading
  status.innerHTML = 'â³ Sedang mengupload...';
  status.style.background = '#e3f2fd';
  status.style.color = '#1565c0';
  
  try {
    // Convert file ke base64
    const base64 = await toBase64(file);
    
    // Data yang akan dikirim
    const data = {
      nama: nama,
      file: base64,
      filename: file.name,
      type: file.type
    };
    
    // Kirim ke server
    const response = await fetch(SCRIPT_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    });
    
    const resultData = await response.json();
    
    if (resultData.success) {
      // Tampilkan sukses
      status.innerHTML = 'âœ… ' + resultData.message;
      status.style.background = '#e8f5e8';
      status.style.color = '#2e7d32';
      
      // Tampilkan link file
      document.getElementById('fileLink').href = resultData.fileUrl;
      result.style.display = 'block';
      
      // Reset form
      document.getElementById('nama').value = '';
      fileInput.value = '';
      
    } else {
      // Tampilkan error
      status.innerHTML = 'âŒ Error: ' + resultData.error;
      status.style.background = '#ffebee';
      status.style.color = '#c62828';
    }
    
  } catch (error) {
    // Tampilkan error network
    status.innerHTML = 'âŒ Gagal terhubung ke server';
    status.style.background = '#ffebee';
    status.style.color = '#c62828';
    console.error('Error:', error);
  }
}

// Convert file ke base64
function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => {
      // Hapus "data:image/jpeg;base64," bagian depan
      const base64 = reader.result.split(',')[1];
      resolve(base64);
    };
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

// Alternatif: Gunakan XMLHttpRequest jika fetch error
function uploadWithXHR(data) {
  return new Promise((resolve, reject) => {
    const xhr = new XMLHttpRequest();
    xhr.open('POST', SCRIPT_URL);
    xhr.setRequestHeader('Content-Type', 'application/json');
    
    xhr.onload = () => {
      try {
        resolve(JSON.parse(xhr.responseText));
      } catch (e) {
        reject(e);
      }
    };
    
    xhr.onerror = reject;
    xhr.send(JSON.stringify(data));
  });
}
</script>

</body>
</html>
