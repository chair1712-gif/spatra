 <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assesmen Diferensiasi PAI Kelas XII</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #4A6FA5;
        }

        header h1 {
            color: #2C3E50;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7F8C8D;
            font-size: 18px;
            font-weight: 500;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #E8E8E8;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2C3E50;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #DDD;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: #4A6FA5;
            outline: none;
        }

        .btn-primary, .btn-next, .btn-restart {
            background: linear-gradient(to right, #4A6FA5, #6A8FC3);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.3s, box-shadow 0.3s;
            width: 100%;
            justify-content: center;
            margin-top: 20px;
        }

        .btn-primary:hover, .btn-next:hover, .btn-restart:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 111, 165, 0.4);
        }

        .soal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .badge {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .badge-teks {
            background: #E3F2FD;
            color: #1565C0;
        }

        .badge-gambar {
            background: #FFF3E0;
            color: #EF6C00;
        }

        .badge-integratif {
            background: #E8F5E9;
            color: #2E7D32;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 18px;
        }

        .soal-counter {
            color: #7F8C8D;
            font-weight: 600;
        }

        .teks-container {
            background: #F8F9FA;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #4A6FA5;
            margin: 20px 0;
            line-height: 1.6;
        }

        .gambar-container {
            text-align: center;
            margin: 25px 0;
        }

        .gambar-soal {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #ddd;
        }

        .gambar-caption {
            margin-top: 15px;
            color: #666;
            font-style: italic;
            font-size: 14px;
        }

        .opsi-container {
            margin: 30px 0;
        }

        .opsi {
            background: #F8F9FA;
            border: 2px solid #E8E8E8;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.3s;
        }

        .opsi:hover {
            background: #E3F2FD;
            border-color: #4A6FA5;
        }

        .opsi.terpilih {
            background: #E3F2FD;
            border-color: #4A6FA5;
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.2);
        }

        .opsi-label {
            background: #4A6FA5;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }

        .opsi.terpilih .opsi-label {
            background: #1565C0;
        }

        .profile-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            margin-bottom: 25px;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .avatar {
            width: 70px;
            height: 70px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .score-card {
            background: rgba(255,255,255,0.9);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .score-card h4 {
            color: #2C3E50;
            margin-bottom: 15px;
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4A6FA5, #6A8FC3);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin: 0 auto 15px;
        }

        .teks-score .score-circle {
            background: linear-gradient(135deg, #1565C0, #42A5F5);
        }

        .gambar-score .score-circle {
            background: linear-gradient(135deg, #EF6C00, #FF9800);
        }

        .analysis-result {
            background: #F8F9FA;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
        }

        .recommendation-card {
            background: white;
            border: 2px solid #E8E8E8;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .recommendation-card h4 {
            color: #2C3E50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .next-questions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .question-chip {
            background: #E3F2FD;
            color: #1565C0;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 500;
            border-left: 4px solid #1565C0;
        }

        .progress-container {
            margin-top: 30px;
            background: #F8F9FA;
            padding: 20px;
            border-radius: 15px;
        }

        .progress-bar {
            height: 10px;
            background: #E8E8E8;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4A6FA5, #6A8FC3);
            width: 0%;
            transition: width 0.5s;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-weight: 500;
        }

        .instruction {
            background: #FFF3CD;
            border: 1px solid #FFEEBA;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            color: #856404;
        }

        .instruction i {
            color: #856404;
            margin-right: 10px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .score-grid {
                grid-template-columns: 1fr;
            }
            
            .next-questions {
                flex-direction: column;
            }
            
            .gambar-soal {
                max-height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1><i class="fas fa-graduation-cap"></i> ASSESMEN PEMBELAJARAN BERDIFERENSIASI</h1>
            <p class="subtitle">PAI Kelas XII - Literasi Teks & Gambar</p>
        </header>

        <!-- Form Siswa -->
        <div class="card" id="form-siswa">
            <h2><i class="fas fa-user"></i> Identitas Siswa</h2>
            <div class="form-group">
                <label for="nama">Nama Lengkap:</label>
                <input type="text" id="nama" placeholder="Masukkan nama lengkap">
            </div>
            <div class="form-group">
                <label for="kelas">Kelas:</label>
                <select id="kelas">
                    <option value="XII IPA 1">XII IPA 1</option>
                    <option value="XII IPA 2">XII IPA 2</option>
                    <option value="XII IPS 1">XII IPS 1</option>
                    <option value="XII IPS 2">XII IPS 2</option>
                </select>
            </div>
            <button onclick="mulaiAssesmen()" class="btn-primary">
                <i class="fas fa-play"></i> Mulai Assesmen
            </button>
        </div>

        <!-- Soal Teks -->
        <div class="card soal-container" id="soal-teks" style="display:none;">
            <div class="soal-header">
                <span class="badge badge-teks"><i class="fas fa-file-alt"></i> LITERASI TEKS</span>
                <span class="soal-counter">Soal 1/2</span>
            </div>
            
            <div class="instruction">
                <i class="fas fa-info-circle"></i>
                <strong>Petunjuk:</strong> Baca teks dengan seksama, kemudian pilih jawaban yang paling tepat!
            </div>
            
            <div class="soal-content">
                <h3 id="teks-soal">Teks tentang zakat fitrah akan muncul di sini...</h3>
                <div class="teks-container" id="teks-container">
                    <!-- Teks akan dimuat dari database -->
                </div>
            </div>

            <div class="opsi-container" id="opsi-container-teks">
                <div class="opsi" data-value="A">
                    <span class="opsi-label">A</span>
                    <span id="opsiA">Opsi A</span>
                </div>
                <div class="opsi" data-value="B">
                    <span class="opsi-label">B</span>
                    <span id="opsiB">Opsi B</span>
                </div>
                <div class="opsi" data-value="C">
                    <span class="opsi-label">C</span>
                    <span id="opsiC">Opsi C</span>
                </div>
                <div class="opsi" data-value="D">
                    <span class="opsi-label">D</span>
                    <span id="opsiD">Opsi D</span>
                </div>
            </div>

            <button onclick="jawabSoal()" class="btn-next" id="btn-next-teks">
                <i class="fas fa-arrow-right"></i> Jawab & Lanjut
            </button>
        </div>

        <!-- Soal Gambar -->
        <div class="card soal-container" id="soal-gambar" style="display:none;">
            <div class="soal-header">
                <span class="badge badge-gambar"><i class="fas fa-image"></i> LITERASI GAMBAR</span>
                <span class="soal-counter">Soal 3/4</span>
            </div>
            
            <div class="instruction">
                <i class="fas fa-info-circle"></i>
                <strong>Petunjuk:</strong> Perhatikan gambar dengan seksama, kemudian pilih jawaban yang paling tepat!
            </div>
            
            <div class="soal-content">
                <h3 id="pertanyaan-gambar">Pertanyaan tentang gambar akan muncul di sini...</h3>
                <div class="gambar-container">
                    <img id="gambar-soal" src="" alt="Gambar soal" class="gambar-soal">
                    <div class="gambar-caption" id="caption-gambar"></div>
                </div>
            </div>

            <div class="opsi-container" id="opsi-container-gambar">
                <div class="opsi" data-value="A">
                    <span class="opsi-label">A</span>
                    <span id="opsiGA">Opsi A</span>
                </div>
                <div class="opsi" data-value="B">
                    <span class="opsi-label">B</span>
                    <span id="opsiGB">Opsi B</span>
                </div>
                <div class="opsi" data-value="C">
                    <span class="opsi-label">C</span>
                    <span id="opsiGC">Opsi C</span>
                </div>
                <div class="opsi" data-value="D">
                    <span class="opsi-label">D</span>
                    <span id="opsiGD">Opsi D</span>
                </div>
            </div>

            <button onclick="jawabSoalGambar()" class="btn-next" id="btn-next-gambar">
                <i class="fas fa-arrow-right"></i> Jawab & Lanjut
            </button>
        </div>

        <!-- Hasil Analisis -->
        <div class="card" id="hasil-analisis" style="display:none;">
            <h2><i class="fas fa-chart-bar"></i> HASIL ANALISIS KEMAMPUAN SISWA</h2>
            
            <div class="profile-section">
                <div class="profile-header">
                    <div class="avatar">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div>
                        <h3 id="nama-siswa">Nama Siswa</h3>
                        <p id="kelas-siswa">Kelas</p>
                    </div>
                </div>

                <div class="score-grid">
                    <div class="score-card teks-score">
                        <h4>LITERASI TEKS</h4>
                        <div class="score-circle" id="score-teks">0%</div>
                        <p>Tingkat Pemahaman: <span id="level-teks">-</span></p>
                    </div>
                    <div class="score-card gambar-score">
                        <h4>LITERASI GAMBAR</h4>
                        <div class="score-circle" id="score-gambar">0%</div>
                        <p>Tingkat Visual: <span id="level-gambar">-</span></p>
                    </div>
                </div>
            </div>

            <div class="analysis-result">
                <h3><i class="fas fa-brain"></i> PROFIL DAYA PIKIR</h3>
                <div class="profile-badge" id="profil-badge">
                    <span class="badge badge-integratif">-</span>
                </div>
                <p id="deskripsi-profil">Profil siswa sedang dianalisis...</p>
            </div>

            <div class="recommendation-section">
                <h3><i class="fas fa-lightbulb"></i> REKOMENDASI PEMBELAJARAN BERDIFERENSIASI</h3>
                
                <div class="recommendation-card">
                    <h4><i class="fas fa-book"></i> METODE PEMBELAJARAN</h4>
                    <p id="metode-belajar">-</p>
                </div>
                
                <div class="recommendation-card">
                    <h4><i class="fas fa-tools"></i> MEDIA & STRATEGI</h4>
                    <p id="media-belajar">-</p>
                </div>

                <div class="recommendation-card">
                    <h4><i class="fas fa-tasks"></i> SOAL BERIKUTNYA YANG DISARANKAN</h4>
                    <div class="next-questions">
                        <div class="question-chip" id="soal-rekomendasi1">-</div>
                        <div class="question-chip" id="soal-rekomendasi2">-</div>
                        <div class="question-chip" id="soal-rekomendasi3">-</div>
                    </div>
                </div>
            </div>

            <button onclick="resetAssesmen()" class="btn-restart">
                <i class="fas fa-redo"></i> Ulang Assesmen
            </button>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container" id="progress-container" style="display:none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text">
                <span>Progress: <span id="progress-text">0%</span></span>
                <span id="soal-status">Soal 0/4</span>
            </div>
        </div>
    </div>

    <script>
        // Database soal lengkap
        const soalDatabase = {
            teks: [
                {
                    id: "T1",
                    teks: "Zakat fitrah adalah zakat yang wajib dikeluarkan setiap muslim yang mampu pada bulan Ramadan, sebelum salat Idul Fitri. Besarnya zakat fitrah adalah setera dengan 2,5 kg atau 3,5 liter makanan pokok seperti beras, gandum, atau kurma. Tujuan zakat fitrah adalah untuk mensucikan diri setelah bulan Ramadan dan membantu fakir miskin.",
                    pertanyaan: "Berdasarkan teks, apa tujuan utama zakat fitrah?",
                    opsi: ["Mensucikan harta", "Mensucikan diri setelah Ramadan", "Wajib bagi setiap muslim", "Sebelum salat Idul Adha"],
                    jawaban: "B",
                    kategori: "Literal",
                    kd: "KD3.1"
                },
                {
                    id: "T2",
                    teks: "Dalam Islam, riba dilarang karena mengandung unsur ketidakadilan dan eksploitasi. Riba dapat merusak ekonomi masyarakat dan menciptakan kesenjangan sosial. Sistem ekonomi Islam menawarkan alternatif seperti mudharabah (bagi hasil) dan murabahah (jual beli dengan margin).",
                    pertanyaan: "Apa alternatif riba yang disebutkan dalam teks?",
                    opsi: ["Sistem kapitalis", "Mudharabah dan murabahah", "Bunga bank konvensional", "Investasi saham"],
                    jawaban: "B",
                    kategori: "Inferensial",
                    kd: "KD3.2"
                }
            ],
            gambar: [
                {
                    id: "G1",
                    pertanyaan: "Simbol apakah ini dan apa maknanya dalam Islam?",
                    gambar_url: "https://png.pngtree.com/png-vector/20200730/ourmid/pngtree-ramadan-stars-and-moon-silhouette-png-image_2317509.jpg",
                    caption: "Bulan dan bintang",
                    opsi: ["Simbol negara Islam", "Lambang bulan Ramadan", "Simbol Islam yang berarti cahaya petunjuk", "Bendera Ottoman"],
                    jawaban: "C",
                    kategori: "Interpretasi Simbol",
                    kd: "KD3.3"
                },
                {
                    id: "G2",
                    pertanyaan: "Apa ibadah yang dilakukan pada gambar ini?",
                    gambar_url: "https://corenews.id/wp-content/uploads/2025/02/kabah.webp",
                    caption: "Ka'bah di Makkah",
                    opsi: ["Shalat Jumat", "Tawaf dalam haji", "Ziarah kubur", "I'tikaf"],
                    jawaban: "B",
                    kategori: "Identifikasi Visual",
                    kd: "KD3.4"
                }
            ]
        };

        // State aplikasi
        let state = {
            siswa: {
                nama: "",
                kelas: "",
                id: ""
            },
            jawaban: [],
            soalTeksIndex: 0,
            soalGambarIndex: 0,
            jenisSoal: 'teks',
            jawabanDipilih: null
        };

        // Fungsi untuk memulai asesmen
        function mulaiAssesmen() {
            const nama = document.getElementById('nama').value.trim();
            const kelas = document.getElementById('kelas').value;
            
            if (!nama) {
                alert('Harap isi nama terlebih dahulu!');
                document.getElementById('nama').focus();
                return;
            }
            
            // Generate ID siswa
            state.siswa = {
                nama: nama,
                kelas: kelas,
                id: 'SISWA_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)
            };
            
            // Reset state
            state.jawaban = [];
            state.soalTeksIndex = 0;
            state.soalGambarIndex = 0;
            state.jawabanDipilih = null;
            
            // Sembunyikan form, tampilkan soal pertama
            document.getElementById('form-siswa').style.display = 'none';
            document.getElementById('soal-teks').style.display = 'block';
            document.getElementById('progress-container').style.display = 'block';
            
            // Tampilkan soal pertama
            tampilkanSoalTeks(0);
            updateProgress();
        }

        // Tampilkan soal teks
        function tampilkanSoalTeks(index) {
            const soal = soalDatabase.teks[index];
            if (!soal) return;
            
            state.jenisSoal = 'teks';
            state.soalTeksIndex = index;
            state.jawabanDipilih = null;
            
            // Update tampilan
            document.getElementById('teks-soal').textContent = soal.pertanyaan;
            document.getElementById('teks-container').innerHTML = `<p>${soal.teks}</p>`;
            
            // Update opsi
            document.getElementById('opsiA').textContent = soal.opsi[0];
            document.getElementById('opsiB').textContent = soal.opsi[1];
            document.getElementById('opsiC').textContent = soal.opsi[2];
            document.getElementById('opsiD').textContent = soal.opsi[3];
            
            // Update counter
            const counterElement = document.querySelector('#soal-teks .soal-counter');
            if (counterElement) {
                counterElement.textContent = `Soal ${index + 1}/${soalDatabase.teks.length}`;
            }
            
            // Reset pilihan
            document.querySelectorAll('#soal-teks .opsi').forEach(el => {
                el.classList.remove('terpilih');
            });
            
            updateProgress();
        }

        // Tampilkan soal gambar
        function tampilkanSoalGambar(index) {
            const soal = soalDatabase.gambar[index];
            if (!soal) return;
            
            state.jenisSoal = 'gambar';
            state.soalGambarIndex = index;
            state.jawabanDipilih = null;
            
            // Update tampilan
            document.getElementById('pertanyaan-gambar').textContent = soal.pertanyaan;
            document.getElementById('gambar-soal').src = soal.gambar_url;
            document.getElementById('gambar-soal').alt = soal.caption;
            document.getElementById('caption-gambar').textContent = soal.caption;
            
            // Update opsi
            document.getElementById('opsiGA').textContent = soal.opsi[0];
            document.getElementById('opsiGB').textContent = soal.opsi[1];
            document.getElementById('opsiGC').textContent = soal.opsi[2];
            document.getElementById('opsiGD').textContent = soal.opsi[3];
            
            // Update counter
            const totalTeks = soalDatabase.teks.length;
            const nomorSoal = totalTeks + index + 1;
            const totalSoal = totalTeks + soalDatabase.gambar.length;
            
            const counterElement = document.querySelector('#soal-gambar .soal-counter');
            if (counterElement) {
                counterElement.textContent = `Soal ${nomorSoal}/${totalSoal}`;
            }
            
            // Reset pilihan
            document.querySelectorAll('#soal-gambar .opsi').forEach(el => {
                el.classList.remove('terpilih');
            });
            
            updateProgress();
        }

        // Event listener untuk opsi
        document.addEventListener('DOMContentLoaded', function() {
            // Event listener untuk opsi teks
            document.querySelectorAll('#opsi-container-teks .opsi').forEach(opsi => {
                opsi.addEventListener('click', function() {
                    const semuaOpsi = document.querySelectorAll('#opsi-container-teks .opsi');
                    semuaOpsi.forEach(o => o.classList.remove('terpilih'));
                    this.classList.add('terpilih');
                    state.jawabanDipilih = this.getAttribute('data-value');
                });
            });
            
            // Event listener untuk opsi gambar
            document.querySelectorAll('#opsi-container-gambar .opsi').forEach(opsi => {
                opsi.addEventListener('click', function() {
                    const semuaOpsi = document.querySelectorAll('#opsi-container-gambar .opsi');
                    semuaOpsi.forEach(o => o.classList.remove('terpilih'));
                    this.classList.add('terpilih');
                    state.jawabanDipilih = this.getAttribute('data-value');
                });
            });
        });

        // Jawab soal teks
        function jawabSoal() {
            if (!state.jawabanDipilih) {
                alert('Silakan pilih jawaban terlebih dahulu!');
                return;
            }
            
            const soal = soalDatabase.teks[state.soalTeksIndex];
            
            // Simpan jawaban
            state.jawaban.push({
                soalId: soal.id,
                jenis: 'teks',
                jawabanSiswa: state.jawabanDipilih,
                jawabanBenar: soal.jawaban,
                kategori: soal.kategori,
                kd: soal.kd
            });
            
            console.log(`Soal ${state.soalTeksIndex + 1} dijawab: ${state.jawabanDipilih} (benar: ${soal.jawaban})`);
            
            // Cek apakah masih ada soal teks
            if (state.soalTeksIndex < soalDatabase.teks.length - 1) {
                // Lanjut ke soal teks berikutnya
                state.soalTeksIndex++;
                tampilkanSoalTeks(state.soalTeksIndex);
            } else {
                // Pindah ke soal gambar
                document.getElementById('soal-teks').style.display = 'none';
                document.getElementById('soal-gambar').style.display = 'block';
                tampilkanSoalGambar(0);
            }
        }

        // Jawab soal gambar
        function jawabSoalGambar() {
            if (!state.jawabanDipilih) {
                alert('Silakan pilih jawaban terlebih dahulu!');
                return;
            }
            
            const soal = soalDatabase.gambar[state.soalGambarIndex];
            
            // Simpan jawaban
            state.jawaban.push({
                soalId: soal.id,
                jenis: 'gambar',
                jawabanSiswa: state.jawabanDipilih,
                jawabanBenar: soal.jawaban,
                kategori: soal.kategori,
                kd: soal.kd
            });
            
            console.log(`Soal gambar ${state.soalGambarIndex + 1} dijawab: ${state.jawabanDipilih} (benar: ${soal.jawaban})`);
            
            // Cek apakah masih ada soal gambar
            if (state.soalGambarIndex < soalDatabase.gambar.length - 1) {
                // Lanjut ke soal gambar berikutnya
                state.soalGambarIndex++;
                tampilkanSoalGambar(state.soalGambarIndex);
            } else {
                // Selesai, tampilkan hasil
                selesaikanAssesmen();
            }
        }

        // Update progress bar
        function updateProgress() {
            const totalSoal = soalDatabase.teks.length + soalDatabase.gambar.length;
            let soalSelesai = state.jawaban.length;
            
            // Hitung progress berdasarkan soal yang sedang dikerjakan
            if (state.jenisSoal === 'teks') {
                soalSelesai += state.soalTeksIndex / soalDatabase.teks.length;
            } else if (state.jenisSoal === 'gambar') {
                soalSelesai += state.soalGambarIndex / soalDatabase.gambar.length;
            }
            
            const persentase = Math.min(100, (soalSelesai / totalSoal) * 100);
            
            document.getElementById('progress-fill').style.width = `${persentase}%`;
            document.getElementById('progress-text').textContent = `${Math.round(persentase)}%`;
            
            const soalSekarang = state.jenisSoal === 'teks' 
                ? state.soalTeksIndex + 1 
                : soalDatabase.teks.length + state.soalGambarIndex + 1;
            
            document.getElementById('soal-status').textContent = `Soal ${soalSekarang}/${totalSoal}`;
        }

        // Analisis hasil
        function selesaikanAssesmen() {
            // Sembunyikan soal, tampilkan hasil
            document.getElementById('soal-gambar').style.display = 'none';
            document.getElementById('progress-container').style.display = 'none';
            
            // Hitung skor
            const hasil = analisisJawaban(state.jawaban);
            
            // Tampilkan hasil
            tampilkanHasil(hasil);
            
            // Kirim data ke Google Sheets
            kirimKeGoogleSheets(hasil);
        }

        // Fungsi analisis jawaban
        function analisisJawaban(jawaban) {
            const hasil = {
                skorTeks: 0,
                skorGambar: 0,
                totalBenar: 0,
                detailJawaban: [],
                profilKognitif: '',
                rekomendasi: {}
            };
            
            // Hitung skor per jenis soal
            const jawabanTeks = jawaban.filter(j => j.jenis === 'teks');
            const jawabanGambar = jawaban.filter(j => j.jenis === 'gambar');
            
            let benarTeks = 0;
            jawabanTeks.forEach(j => {
                const benar = j.jawabanSiswa === j.jawabanBenar;
                if (benar) benarTeks++;
                hasil.detailJawaban.push({
                    soalId: j.soalId,
                    jenis: j.jenis,
                    jawabanSiswa: j.jawabanSiswa,
                    jawabanBenar: j.jawabanBenar,
                    benar: benar,
                    kategori: j.kategori
                });
            });
            
            let benarGambar = 0;
            jawabanGambar.forEach(j => {
                const benar = j.jawabanSiswa === j.jawabanBenar;
                if (benar) benarGambar++;
                hasil.detailJawaban.push({
                    soalId: j.soalId,
                    jenis: j.jenis,
                    jawabanSiswa: j.jawabanSiswa,
                    jawabanBenar: j.jawabanBenar,
                    benar: benar,
                    kategori: j.kategori
                });
            });
            
            // Hitung persentase
            hasil.skorTeks = jawabanTeks.length > 0 ? (benarTeks / jawabanTeks.length) * 100 : 0;
            hasil.skorGambar = jawabanGambar.length > 0 ? (benarGambar / jawabanGambar.length) * 100 : 0;
            hasil.totalBenar = benarTeks + benarGambar;
            
            // Tentukan profil kognitif
            hasil.profilKognitif = tentukanProfil(hasil.skorTeks, hasil.skorGambar);
            
            // Tentukan rekomendasi
            hasil.rekomendasi = tentukanRekomendasi(hasil.profilKognitif, hasil.skorTeks, hasil.skorGambar);
            
            console.log('Hasil analisis:', hasil);
            return hasil;
        }

        // Tentukan profil berdasarkan skor
        function tentukanProfil(skorTeks, skorGambar) {
            const rataRata = (skorTeks + skorGambar) / 2;
            
            if (rataRata >= 80) {
                if (Math.abs(skorTeks - skorGambar) <= 15) {
                    return 'INTEGRATIF';
                } else if (skorTeks > skorGambar) {
                    return 'VERBAL-ANALITIS';
                } else {
                    return 'VISUAL-SPASIAL';
                }
            } else if (rataRata >= 60) {
                if (skorTeks > skorGambar) {
                    return 'VERBAL-MENENGAH';
                } else {
                    return 'VISUAL-MENENGAH';
                }
            } else {
                if (skorTeks > skorGambar) {
                    return 'VERBAL-DASAR';
                } else if (skorGambar > skorTeks) {
                    return 'VISUAL-DASAR';
                } else {
                    return 'PERLU BIMBINGAN INTENSIF';
                }
            }
        }

        // Tentukan rekomendasi
        function tentukanRekomendasi(profil, skorTeks, skorGambar) {
            const rekomendasi = {
                metode: '',
                media: '',
                soalBerikutnya: []
            };
            
            switch(profil) {
                case 'INTEGRATIF':
                    rekomendasi.metode = 'Project-Based Learning dengan pendekatan multidisiplin';
                    rekomendasi.media = 'Multimedia interaktif, diskusi panel, proyek penelitian';
                    rekomendasi.soalBerikutnya = [
                        'Analisis kasus zakat kontemporer dengan data statistik',
                        'Membuat infografik tentang perkembangan ekonomi syariah',
                        'Proyek penelitian kecil tentang etika bisnis Islam'
                    ];
                    break;
                    
                case 'VERBAL-ANALITIS':
                    rekomendasi.metode = 'Diskusi mendalam, analisis teks, debat ilmiah';
                    rekomendasi.media = 'Artikel akademik, jurnal penelitian, forum diskusi';
                    rekomendasi.soalBerikutnya = [
                        'Analisis perbandingan sistem ekonomi konvensional vs syariah',
                        'Penulisan artikel opini tentang isu fiqh kontemporer',
                        'Debat tentang implementasi maqashid syariah di era modern'
                    ];
                    break;
                    
                case 'VISUAL-SPASIAL':
                    rekomendasi.metode = 'Visual thinking, mind mapping, media kreatif';
                    rekomendasi.media = 'Video animasi, infografik, diagram interaktif';
                    rekomendasi.soalBerikutnya = [
                        'Membuat timeline sejarah perkembangan ilmu pengetahuan Islam',
                        'Design poster kampanye anti-riba',
                        'Membuat storyboard video edukasi tentang haji'
                    ];
                    break;
                    
                default:
                    rekomendasi.metode = 'Pembelajaran terstruktur dengan scaffolding';
                    rekomendasi.media = 'Media konkret, contoh nyata, simulasi sederhana';
                    rekomendasi.soalBerikutnya = [
                        'Latihan identifikasi konsep dasar zakat',
                        'Matching game: istilah dan pengertian',
                        'Studi kasus sederhana tentang akhlak sehari-hari'
                    ];
            }
            
            return rekomendasi;
        }

        // Tampilkan hasil
        function tampilkanHasil(hasil) {
            document.getElementById('hasil-analisis').style.display = 'block';
            
            // Update data siswa
            document.getElementById('nama-siswa').textContent = state.siswa.nama;
            document.getElementById('kelas-siswa').textContent = state.siswa.kelas;
            
            // Update skor
            document.getElementById('score-teks').textContent = `${Math.round(hasil.skorTeks)}%`;
            document.getElementById('score-gambar').textContent = `${Math.round(hasil.skorGambar)}%`;
            
            // Update level
            const levelTeks = hasil.skorTeks >= 80 ? 'Tinggi' : hasil.skorTeks >= 60 ? 'Sedang' : 'Perlu Bimbingan';
            const levelGambar = hasil.skorGambar >= 80 ? 'Tinggi' : hasil.skorGambar >= 60 ? 'Sedang' : 'Perlu Bimbingan';
            
            document.getElementById('level-teks').textContent = levelTeks;
            document.getElementById('level-gambar').textContent = levelGambar;
            
            // Update profil
            document.getElementById('profil-badge').innerHTML = 
                `<span class="badge badge-integratif">${hasil.profilKognitif}</span>`;
            
            document.getElementById('deskripsi-profil').textContent = 
                getDeskripsiProfil(hasil.profilKognitif);
            
            // Update rekomendasi
            document.getElementById('metode-belajar').textContent = hasil.rekomendasi.metode;
            document.getElementById('media-belajar').textContent = hasil.rekomendasi.media;
            
            document.getElementById('soal-rekomendasi1').textContent = hasil.rekomendasi.soalBerikutnya[0] || '';
            document.getElementById('soal-rekomendasi2').textContent = hasil.rekomendasi.soalBerikutnya[1] || '';
            document.getElementById('soal-rekomendasi3').textContent = hasil.rekomendasi.soalBerikutnya[2] || '';
        }

        // Deskripsi profil
        function getDeskripsiProfil(profil) {
            const deskripsi = {
                'INTEGRATIF': 'Siswa memiliki kemampuan yang seimbang dalam memproses informasi teks dan visual. Dapat mengintegrasikan berbagai sumber informasi dengan baik untuk memahami konsep secara holistik.',
                'VERBAL-ANALITIS': 'Siswa lebih kuat dalam pemrosesan informasi verbal dan analisis teks. Lebih nyaman dengan materi berbasis bacaan, diskusi, dan analisis logis.',
                'VISUAL-SPASIAL': 'Siswa memiliki kemampuan visual yang kuat. Lebih mudah memahami konsep melalui gambar, diagram, peta konsep, dan representasi visual lainnya.',
                'VERBAL-MENENGAH': 'Kemampuan verbal cukup baik dengan dasar pemahaman teks yang memadai, namun perlu penguatan dalam aspek visual-spasial untuk pemahaman yang lebih komprehensif.',
                'VISUAL-MENENGAH': 'Kemampuan visual cukup baik untuk memahami gambar dan diagram, namun perlu penguatan dalam pemahaman teks analitis dan argumentasi tertulis.',
                'VERBAL-DASAR': 'Perlu penguatan dasar dalam pemahaman teks dan kemampuan verbal. Disarankan pembelajaran dengan teks sederhana dan pendampingan intensif.',
                'VISUAL-DASAR': 'Perlu penguatan dasar dalam pemahaman visual. Disarankan pembelajaran dengan media visual konkret dan contoh-contoh nyata.',
                'PERLU BIMBINGAN INTENSIF': 'Siswa memerlukan pendampingan khusus untuk mengembangkan kemampuan literasi dasar baik teks maupun visual. Pendekatan individual sangat disarankan.'
            };
            
            return deskripsi[profil] || 'Profil belajar siswa berhasil dianalisis. Hasil menunjukkan pola spesifik dalam pemrosesan informasi.';
        }

        // Kirim data ke Google Sheets
        function kirimKeGoogleSheets(hasil) {
            const data = {
                siswa: state.siswa,
                hasil: hasil,
                timestamp: new Date().toISOString()
            };
            
            console.log('Data yang akan dikirim ke Google Sheets:', data);
            
            // URL Apps Script Anda
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzykWF3bOlsaYc-Qh4MY_iBQQphY2D2O8hCs-jPiHz_U2KqRpDxovcLcapmX3UnKIGU/exec';
            
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                console.log('Data berhasil dikirim ke Google Sheets');
            })
            .catch(error => {
                console.error('Error mengirim data:', error);
            });
        }

        // Reset asesmen
        function resetAssesmen() {
            state = {
                siswa: { nama: "", kelas: "", id: "" },
                jawaban: [],
                soalTeksIndex: 0,
                soalGambarIndex: 0,
                jenisSoal: 'teks',
                jawabanDipilih: null
            };
            
            document.getElementById('hasil-analisis').style.display = 'none';
            document.getElementById('form-siswa').style.display = 'block';
            document.getElementById('nama').value = '';
            document.getElementById('kelas').value = 'XII IPA 1';
            
            // Reset progress bar
            document.getElementById('progress-fill').style.width = '0%';
            document.getElementById('progress-text').textContent = '0%';
            document.getElementById('soal-status').textContent = 'Soal 0/4';
        }
    </script>
</body>
</html>
